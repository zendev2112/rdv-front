"use strict";(()=>{var e={};e.id=114,e.ids=[114],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4722:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var o={};r.r(o),r.d(o,{GET:()=>l});var s=r(9303),n=r(8716),i=r(670),a=r(7070),c=r(5662);async function l(e,{params:t}){try{let r=e.nextUrl.searchParams,o=parseInt(r.get("offset")||"0",10),s=parseInt(r.get("limit")||"12",10),{articles:n}=await (0,c.hE)(t.slug,Math.floor(o/s)+1,s);return a.NextResponse.json(n)}catch(e){return console.error("Error fetching section articles:",e),a.NextResponse.json({error:"Failed to fetch articles"},{status:500})}}let u=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/sections/[slug]/route",pathname:"/api/sections/[slug]",filename:"route",bundlePath:"app/api/sections/[slug]/route"},resolvedPagePath:"/home/zen/Documents/rdv-frontend/app/api/sections/[slug]/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:g}=u,h="/api/sections/[slug]/route";function f(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}},5662:(e,t,r)=>{r.d(t,{AX:()=>s,OQ:()=>o,hE:()=>n});let o=(0,r(2885).createClient)("https://btpuvblcktpeplfkwcbr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ0cHV2Ymxja3RwZXBsZmt3Y2JyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI5Mzk1ODcsImV4cCI6MjA1ODUxNTU4N30.949K9yGdElNqqJbeg1tB-0zmOxocsnacP_IW7a96mdw");async function s(e){console.log(`Fetching article with slug: ${e}`);let{data:t,error:r}=await o.from("article_with_sections").select("*").eq("slug",e).eq("status","published").eq("is_primary",!0).single();return r||!t?(console.error(`Article not found: ${e}`,r),null):(console.log(`Found article: ${t.title}`),t)}async function n(e,t=1,r=12){console.log(`Fetching parent section articles for: ${e}, page ${t}`);let{data:s,error:n}=await o.from("section_hierarchy").select("*").eq("slug",e).single();if(n||!s)return console.error(`Parent section not found: ${e}`,n),{articles:[],count:0};console.log("Parent section found:",s),console.log(`Parent section ID: ${s.id}, Path: ${s.path}`);let{data:a,error:c}=await o.rpc("get_section_tree",{parent_path:s.path});if(c){console.error("Error fetching child sections:",c),console.log("Falling back to parent section only");let e=[s.id];return await i(e,t,r)}console.log(`Found ${a?.length||0} sections in hierarchy:`,a);let l=a?.map(e=>e.id)||[s.id];return 0===l.length&&(console.log("No sections found in hierarchy, using parent only"),l.push(s.id)),await i(l,t,r)}async function i(e,t,r){console.log("Querying articles with section_ids:",e);let{count:s,error:n}=await o.from("article_with_sections").select("*",{count:"exact",head:!0}).in("section_id",e).eq("status","published");n&&console.error("Error counting articles:",n),console.log(`Total articles found in hierarchy: ${s}`);let{data:i,error:a}=await o.from("article_with_sections").select("*").in("section_id",e).eq("status","published").order("created_at",{ascending:!1}).range((t-1)*r,t*r-1);return a?(console.error("Error fetching articles:",a),{articles:[],count:0}):(console.log(`Found ${i?.length||0} articles for page ${t}`),console.log("Sample articles:",i?.slice(0,2)),{articles:i||[],count:s||0})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[948,972],()=>r(4722));module.exports=o})();